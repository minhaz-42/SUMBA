<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Keys - SUMBA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#6366f1',
                        'primary-dark': '#4f46e5',
                        'secondary': '#10b981',
                        'dark': '#1e1b4b',
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <style>body { font-family: 'Inter', sans-serif; } .mono { font-family: 'JetBrains Mono', monospace; }</style>
</head>
<body class="bg-gray-100 min-h-screen">
    <!-- Navigation -->
    <nav class="bg-white border-b border-gray-200">
        <div class="max-w-7xl mx-auto px-6 py-4">
            <div class="flex items-center justify-between">
                <a href="/" class="flex items-center space-x-2">
                    <div class="w-10 h-10 bg-primary rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 11.5V14m0-2.5v-6a1.5 1.5 0 113 0m-3 6a1.5 1.5 0 00-3 0v2a7.5 7.5 0 0015 0v-5a1.5 1.5 0 00-3 0m-6-3V11m0-5.5v-1a1.5 1.5 0 013 0v1m0 0V11m0-5.5a1.5 1.5 0 013 0v3m0 0V11"></path>
                        </svg>
                    </div>
                    <span class="text-xl font-bold text-dark">SUMBA</span>
                </a>
                <div class="flex items-center space-x-4">
                    <a href="{% url 'profile' %}" class="text-gray-600 hover:text-primary transition">Profile</a>
                    <a href="{% url 'dashboard' %}" class="text-gray-600 hover:text-primary transition">Dashboard</a>
                    <a href="{% url 'logout' %}" class="px-4 py-2 text-red-600 hover:bg-red-50 rounded-lg transition">Sign Out</a>
                </div>
            </div>
        </div>
    </nav>

    <main class="max-w-4xl mx-auto px-6 py-8">
        <div class="flex items-center justify-between mb-8">
            <div>
                <h1 class="text-3xl font-bold text-gray-900">API Keys</h1>
                <p class="text-gray-600 mt-1">Manage your API access for programmatic integration</p>
            </div>
            <a href="{% url 'profile' %}" class="text-primary hover:underline">‚Üê Back to Profile</a>
        </div>
        
        {% if messages %}
            {% for message in messages %}
                <div class="mb-6 p-4 rounded-xl {% if message.tags == 'error' %}bg-red-50 text-red-700{% elif message.tags == 'warning' %}bg-yellow-50 text-yellow-700{% else %}bg-green-50 text-green-700{% endif %}">
                    {{ message }}
                </div>
            {% endfor %}
        {% endif %}
        
        <div class="bg-white rounded-2xl shadow-sm p-6 mb-6">
            <h2 class="text-xl font-semibold mb-4">Your API Key</h2>
            
            {% if api_key %}
                <div class="bg-gray-900 rounded-xl p-4 mb-4">
                    <div class="flex items-center justify-between">
                        <code id="api-key" class="mono text-green-400 text-sm">{{ api_key }}</code>
                        <button onclick="copyApiKey()" class="px-3 py-1 bg-gray-700 text-gray-300 rounded hover:bg-gray-600 transition text-sm">
                            Copy
                        </button>
                    </div>
                </div>
                
                <div class="flex items-center justify-between">
                    <p class="text-gray-500 text-sm">
                        <span class="font-medium text-gray-700">{{ api_requests_count }}</span> API requests made
                    </p>
                    <div class="flex gap-3">
                        <form method="post" action="{% url 'generate_api_key' %}">
                            {% csrf_token %}
                            <button type="submit" class="px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark transition">
                                Regenerate Key
                            </button>
                        </form>
                        <form method="post" action="{% url 'revoke_api_key' %}" onsubmit="return confirm('Are you sure? This will disable all API access.')">
                            {% csrf_token %}
                            <button type="submit" class="px-4 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition">
                                Revoke Key
                            </button>
                        </form>
                    </div>
                </div>
            {% else %}
                <div class="text-center py-8">
                    <svg class="w-16 h-16 mx-auto text-gray-300 mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"></path>
                    </svg>
                    <p class="text-gray-600 mb-4">You don't have an API key yet</p>
                    <form method="post" action="{% url 'generate_api_key' %}">
                        {% csrf_token %}
                        <button type="submit" class="px-6 py-3 bg-primary text-white rounded-xl hover:bg-primary-dark transition">
                            Generate API Key
                        </button>
                    </form>
                </div>
            {% endif %}
        </div>
        
        <!-- API Usage Examples -->
        <div class="bg-white rounded-2xl shadow-sm p-6">
            <h2 class="text-xl font-semibold mb-4">Usage Examples</h2>
            
            <div class="space-y-6">
                <!-- Python Example -->
                <div>
                    <h3 class="font-medium text-gray-900 mb-2">Python</h3>
                    <pre class="bg-gray-900 rounded-xl p-4 overflow-x-auto"><code class="mono text-sm text-gray-100">import requests

API_KEY = "your_api_key_here"
BASE_URL = "http://localhost:8000/api"

headers = {"Authorization": f"Bearer {API_KEY}"}

# Get gesture samples
response = requests.get(f"{BASE_URL}/gestures/samples/", headers=headers)
samples = response.json()

# Submit inference request
data = {
    "frames": [...],  # Your skeletal data
    "model": "hybrid",
    "language": "ASL"
}
response = requests.post(f"{BASE_URL}/inference/predict/", json=data, headers=headers)
translation = response.json()</code></pre>
                </div>
                
                <!-- cURL Example -->
                <div>
                    <h3 class="font-medium text-gray-900 mb-2">cURL</h3>
                    <pre class="bg-gray-900 rounded-xl p-4 overflow-x-auto"><code class="mono text-sm text-gray-100"># List datasets
curl -H "Authorization: Bearer YOUR_API_KEY" \
     http://localhost:8000/api/datasets/

# Upload gesture sample
curl -X POST \
     -H "Authorization: Bearer YOUR_API_KEY" \
     -H "Content-Type: application/json" \
     -d '{"gloss": "hello", "frames": [...]}' \
     http://localhost:8000/api/gestures/samples/</code></pre>
                </div>
                
                <!-- JavaScript Example -->
                <div>
                    <h3 class="font-medium text-gray-900 mb-2">JavaScript</h3>
                    <pre class="bg-gray-900 rounded-xl p-4 overflow-x-auto"><code class="mono text-sm text-gray-100">const API_KEY = 'your_api_key_here';

const response = await fetch('/api/gestures/samples/', {
    headers: {
        'Authorization': `Bearer ${API_KEY}`,
        'Content-Type': 'application/json'
    }
});

const samples = await response.json();</code></pre>
                </div>
            </div>
        </div>
    </main>
    
    <script>
        function copyApiKey() {
            const key = document.getElementById('api-key').textContent;
            navigator.clipboard.writeText(key).then(() => {
                alert('API key copied to clipboard!');
            });
        }
    </script>
</body>
</html>
